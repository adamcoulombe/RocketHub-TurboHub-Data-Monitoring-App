(this["webpackJsonpget-data-usage"]=this["webpackJsonpget-data-usage"]||[]).push([[0],{15:function(a,e,t){a.exports=t(33)},20:function(a,e,t){},33:function(a,e,t){"use strict";t.r(e);var s=t(0),n=t.n(s),r=t(8),i=t.n(r),o=t(4),l=t(9),c=t(10),d=t(14),m=t(13),u=(t(20),t(2)),h=t.n(u),p=t(1),g=t.n(p),f=t(3),v=t.n(f),y=t(11),b=t.n(y),E=t(12),w=t.n(E).a,N=function(a){Object(d.a)(t,a);var e=Object(m.a)(t);function t(a){var s;return Object(l.a)(this,t),(s=e.call(this,a)).state={currentData:[],resetsData:[],range:"today",currentScroll:0,currentUsage:"",todayUsage:"",mainChart:{options:{chart:{id:"data-usage"},xaxis:{categories:[]}},series:[{name:"usage",data:[]}]},dataLabels:{enabled:!1},todayGaugeOptions:{},todayGaugeSeries:[]},s}return Object(c.a)(t,[{key:"componentWillMount",value:function(){this.getData()}},{key:"componentDidMount",value:function(){var a=this;w(window).on("scroll",(function(e){a.setState({currentScroll:window.scrollY})})),w(window).on("touchend",(function(e){a.setState({currentScroll:window.scrollY}),a.state.currentScroll<-65&&window.location.reload()})),window.matchMedia("(display-mode: standalone)").matches&&w("html").addClass("is-pwa"),"ontouchstart"in document.documentElement?w("html").addClass("is-touch"):w("html").addClass("no-touch")}},{key:"getData",value:function(){var a=this;Promise.all([fetch("http://"+window.location.hostname+":3901/api/current?timestamp="+g()().valueOf()),fetch("http://"+window.location.hostname+":3901/api/previous?timestamp="+g()().valueOf()),fetch("http://"+window.location.hostname+":3901/api/resets?timestamp="+g()().valueOf())]).then((function(e){var t=Object(o.a)(e,3),s=t[0],n=t[1],r=t[2];Promise.all([s.text(),n.text(),r.text()]).then((function(e){var t=Object(o.a)(e,3),s=t[0],n=t[1],r=t[2];a.setState({currentData:JSON.parse(s),previousData:JSON.parse(n),resetsData:JSON.parse(r)},a.updateChartData.bind(a))}))})).catch((function(a){console.log(a)}))}},{key:"updateChartData",value:function(){var a,e;g()().date(9).endOf("day").isBefore(g()())?(a=g()().date(10).startOf("day"),e=g()().date(10).add(1,"months").endOf("day")):(a=g()().date(10).subtract(1,"months").startOf("day"),e=g()().date(10).endOf("day"));var t=e.diff(g()(),"days"),s=g()().startOf("day"),n=h.a.partition(this.state.currentData,(function(a){return console.log(g()(a.time).isBefore(s)),g()(a.time).isBefore(s)}));console.log(n);var r=n[0],i=n[1],o=this.state.previousData,l=this.state.resetsData,c=h.a.filter(l,(function(e){return g()(e.time).isAfter(a)})),d=this.state.currentData.map((function(a){return a.dataCorrected||h.a.each(c,(function(e){if(g()(a.time).isAfter(e.time)){var t=parseFloat(a.usage),s=parseFloat(e.usage);a.usage=(t+s).toFixed(2)+"GB"}})),a.dataCorrected=!0,a}));"last-hour"==this.state.range?d=h.a.filter(this.state.currentData,(function(a){return g()(a.time).isSameOrAfter(g()().subtract(1,"hour"))})):"all"==this.state.range?d=this.state.currentData:"today"==this.state.range&&(d=i);var m=parseFloat(h.a.last(o).usage),u=r.length>0?parseFloat(h.a.last(r).usage):m,p=(parseFloat(h.a.last(this.state.currentData).usage)-m).toFixed(2),f=((200-p)/t).toFixed(2),v=(parseFloat(h.a.last(this.state.currentData).usage)-u).toFixed(2),y=h.a.map(d,"time"),E=h.a.map(d,"usage").map((function(a){return(parseFloat(a)-m).toFixed(2)})),w=b()(["#33e9ab","#33e9ab","#33e9ab","#67b244","#67b244","#67b244","#E0B336","#E0B336","#E0B336","#fd9a2d","#fd9a2d","#fd9a2d","#fd5f76","#fd5f76","#fd5f76"]),N=y.map((function(a){return g()(a).format("dd M, h:mmA")}));this.setState({currentUsage:p,todayUsage:v,remainingDailyDataThisPeriod:f,mainChart:{options:{chart:{id:"data-usage"},xaxis:{categories:N},dataLabels:{enabled:!1}},series:[{name:"usage",data:E}]},todayGaugeSeries:[v/f*100],todayGaugeOptions:{chart:{type:"radialBar",offsetY:-20,sparkline:{enabled:!0}},plotOptions:{radialBar:{startAngle:-90,endAngle:90,track:{background:"#e7e7e7",strokeWidth:"97%",margin:5},dataLabels:{name:{show:!1},value:{show:!1}}}},grid:{padding:{top:-10}},fill:{colors:[w(v/f)]}}})}},{key:"setRange",value:function(a){this.setState({range:a},this.updateChartData.bind(this))}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"ptr-status"},"Pull to reload"),n.a.createElement("div",{className:"app-inner"},n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"kpi"},n.a.createElement("div",{className:"kpi-data"},n.a.createElement("div",{className:"label"},"Month's Usage"),n.a.createElement("div",{className:"number"},this.state.currentUsage,n.a.createElement("span",{className:"unit"}," / 200GB")))),n.a.createElement("div",{className:"kpi"},n.a.createElement("div",{className:"meter"},n.a.createElement(v.a,{options:this.state.todayGaugeOptions,series:this.state.todayGaugeSeries,type:"radialBar",height:"280"})),n.a.createElement("div",{className:"kpi-data"},n.a.createElement("div",{className:"label"},"Today's Usage"),n.a.createElement("div",{className:"number"},this.state.todayUsage,n.a.createElement("span",{className:"unit"}," / ",this.state.remainingDailyDataThisPeriod,"GB"))))),n.a.createElement("div",{className:["chart-panel","range-".concat(this.state.range)].join(" ")},n.a.createElement("div",{className:"nav-wrap"},n.a.createElement("nav",{id:"nav"},n.a.createElement("div",{className:"nav-inner"},n.a.createElement("a",{className:"nav-item nav-item-today",onClick:this.setRange.bind(this,"today")},"Today"),n.a.createElement("a",{className:"nav-item nav-item-current-period",onClick:this.setRange.bind(this,"current-period")},"This Month"),n.a.createElement("a",{className:"nav-item nav-item-last-hour",onClick:this.setRange.bind(this,"last-hour")},"Last Hour"),n.a.createElement("a",{className:"nav-item nav-item-all",onClick:this.setRange.bind(this,"all")},"All")))),n.a.createElement(v.a,{options:this.state.mainChart.options,toolbar:this.state.toolbar,series:this.state.mainChart.series,type:"area",height:"300"}))))}}]),t}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(a){a.unregister()})).catch((function(a){console.error(a.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.7c0329f5.chunk.js.map